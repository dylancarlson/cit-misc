10 REM Net69 to Cit86 Packet Translator
20 REM
30 NUL$ = CHR$(0): FF$ = CHR$(255)
50 OPEN "MSG.69" FOR INPUT AS #1
60 OPEN "BCH86SH.000" FOR OUTPUT AS #2
70 IF EOF(1) GOTO 3000
72 IN$ = INPUT$(1, #1)
74 IF IN$ = NUL$ THEN GOTO 100 ELSE GOTO 70
99 DOH$="":A$="":DT$="":O$="":S$="":M$="":R$="":X$="":D$="":C$="":A=0:P$=""
100 IF EOF(1) GOTO 3000
101 IN$ = INPUT$(1, #1)
105 IF IN$ = FF$ THEN GOSUB 200:GOTO 99
107 IF IN$ = NUL$ GOTO 99
110 R$ = R$ + IN$: ROOM$ = R$: GOTO 101
200 IN$ = INPUT$(1, #1): IF IN$ <> NUL$ THEN STOP
201 IN$ = INPUT$(1, #1)
210 IF IN$ = "A" GOTO 250
212 IF IN$ = "d" GOTO 300
214 IF IN$ = "O" GOTO 350
216 IF IN$ = "S" GOTO 400
217 IF IN$ = "P" GOTO 425
218 IF IN$ = "M" GOTO 450
220 IN$ = INPUT$(1, #1)
222 IF IN$ = NUL$ THEN GOTO 201
224 DOH$ = DOH$ + IN$
225 GOTO 220
250 IN$ = INPUT$(1, #1)
255 IF IN$ = NUL$ THEN GOTO 201
256 IF IN$ = CHR$(1) THEN IN$=INPUT$(1,#1):GOTO 250
260 A$ = A$ + IN$
265 GOTO 250
300 IN$ = INPUT$(1, #1)
305 IF IN$ = NUL$ THEN GOTO 201
306 IF IN$ = CHR$(1) THEN IN$=INPUT$(1,#1):GOTO 300
310 DT$ = DT$ + IN$
315 GOTO 300
350 IN$ = INPUT$(1, #1)
355 IF IN$ = NUL$ THEN GOTO 201
356 IF IN$ = CHR$(1) THEN IN$=INPUT$(1,#1):GOTO 350
360 O$ = O$ + IN$
365 GOTO 350
400 IN$ = INPUT$(1, #1)
405 IF IN$ = NUL$ THEN GOTO 201
406 IF IN$ = CHR$(1) THEN IN$=INPUT$(1,#1):GOTO 400
410 S$ = S$ + IN$
415 GOTO 400
425 IN$ = INPUT$(1, #1)
430 IF IN$=NUL$ THEN GOTO 201
431 IF IN$=CHR$(1) THEN IN$=INPUT$(1,#1):GOTO 425
432 IF IN$="!" THEN GOTO 201
435 P$=P$+IN$
440 GOTO 425
450 A=A+1:IN$ = INPUT$(1, #1)
455 IF IN$ = NUL$ THEN GOTO 500
456 IF IN$ = CHR$(1) THEN IN$=INPUT$(1,#1):GOTO 450
460 IF A<7499 THEN M$=M$+IN$ ELSE GOTO 500
465 GOTO 450
500 X$ = "CitPlNet"
510 TS$ = S$: S$ = "": A = 0: B = 0
520 A = VAL(TS$) / 65535: A = FIX(A): B = VAL(TS$) MOD 65535: B = B - A
525 S1$ = STR$(A): S2$ = STR$(B): S$ = RIGHT$(S1$, (LEN(S1$) - 1)) + S2$
530 D$=LEFT$(DT$,7)
535 IF LEN(O$)<20 THEN C=LEN(O$) ELSE C=20
540 O$=LEFT$(O$,C)
550 HH$=MID$(DT$,9,2)
555 IF VAL(HH$)<12 THEN AD$="am"
556 IF VAL(HH$)>12 THEN HH$=STR$(VAL(HH$)-12):AD$="pm"
560 TC$=HH$+MID$(DT$,11,3)+" "+AD$
565 FOR P=2 TO LEN(TC$):C$=C$+MID$(TC$,P,1):NEXT P
1000 PRINT #2, "A"; A$; NUL$;
1010 PRINT #2, "D"; D$; NUL$;
1020 PRINT #2, "C"; C$; NUL$;
1030 PRINT #2, "N"; O$; NUL$;
1040 PRINT #2, "X"; X$; NUL$;
1045 PRINT #2, "O"; P$; NUL$;
1050 PRINT #2, "R"; ROOM$; NUL$;
1060 PRINT #2, "S"; S$; NUL$;
1070 PRINT #2, "M"; M$; NUL$;
1100 RETURN
3000 CLOSE #1: CLOSE #2
3010 SYSTEM

