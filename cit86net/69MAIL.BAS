10 REM Net69 to Cit86 Mail Translator
20 REM
30 NUL$ = CHR$(0): FF$ = CHR$(255)
50 OPEN "MESG.TMP" FOR INPUT AS #1
60 OPEN "BCH86SH.000" FOR APPEND AS #2
99 DOH$ = "": A$ = "": DT$ = "": O$ = "": S$ = "": M$ = "":P$=""
100 X$ = "": D$ = "": C$ = "": Z$ = "": T$ = "":DD$="":HH$="":YY$=""
200 IF EOF(1) GOTO 3000
201 IN$ = INPUT$(1, #1)
209 IF IN$ = ">" GOTO 99
210 IF IN$ = "A" GOTO 250
212 IF IN$ = "D" GOTO 300
213 IF IN$ = "P" GOTO 325
214 IF IN$ = "O" GOTO 350
215 IF IN$ = "Z" GOTO 375
216 IF IN$ = "S" GOTO 400
217 IF IN$ = "T" GOTO 425
218 IF IN$ = "M" GOTO 450
220 IN$ = INPUT$(1, #1)
222 IF IN$ = NUL$ THEN GOTO 200
224 DOH$ = DOH$ + IN$
225 GOTO 220
250 IN$ = INPUT$(1, #1)
255 IF IN$ = NUL$ THEN GOTO 200
256 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 250
260 A$ = A$ + IN$
265 GOTO 250
300 IN$ = INPUT$(1, #1)
305 IF IN$ = NUL$ THEN GOTO 200
306 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 300
310 D$ = D$ + IN$
315 GOTO 300
325 IN$ = INPUT$(1, #1)
330 IF IN$ = NUL$ THEN GOTO 200
331 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 325
332 IF IN$ = "!" THEN GOTO 200
335 P$ = P$+IN$
340 GOTO 325
350 IN$ = INPUT$(1, #1)
355 IF IN$ = NUL$ THEN GOTO 200
356 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 350
360 O$ = O$ + IN$
365 GOTO 350
375 IN$ = INPUT$(1, #1)
380 IF IN$ = NUL$ THEN GOTO 200
385 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 375
390 Z$ = Z$ + IN$
395 GOTO 375
400 IN$ = INPUT$(1, #1)
405 IF IN$ = NUL$ THEN GOTO 200
406 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 400
410 S$ = S$ + IN$
415 GOTO 400
425 IN$ = INPUT$(1, #1)
430 IF IN$ = NUL$ THEN GOTO 200
435 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 425
440 T$ = T$ + IN$
445 GOTO 425
450 IN$ = INPUT$(1, #1)
455 IF IN$ = NUL$ THEN GOTO 500
456 IF IN$ = CHR$(1) THEN IN$ = INPUT$(1, #1): GOTO 450
460 M$ = M$ + IN$
465 GOTO 450
500 X$ = "CitPlNet"
510 TS$ = S$: S$ = "": A = 0: B = 0
520 A = VAL(TS$) / 65535: A = FIX(A): B = VAL(TS$) MOD 65535: B = B - A
525 S1$ = STR$(A): S2$ = STR$(B): S$ = RIGHT$(S1$, (LEN(S1$) - 1)) + S2$
530 GOSUB 5000
1000 PRINT #2, "A"; A$; NUL$;
1010 PRINT #2, "D"; DT$; NUL$;
1020 PRINT #2, "C"; TM$; NUL$;
1030 PRINT #2, "N"; O$; NUL$;
1040 PRINT #2, "X"; X$; NUL$;
1045 PRINT #2, "P"; P$; NUL$;
1050 PRINT #2, "RMail"; NUL$;
1060 PRINT #2, "S"; S$; NUL$;
1064 PRINT #2, "T"; T$; NUL$;
1065 PRINT #2, "Q"; Z$; NUL$;
1070 PRINT #2, "M"; M$; NUL$;
1100 GOTO 99
3000 CLOSE #1: CLOSE #2
3010 SYSTEM
5000 S = VAL(D$) - 18000
5005 DAYS = FIX(S / 86400)
5010 YEARS = FIX(DAYS / 365)
5020 YEARS = 70 + YEARS: YY$ = STR$(YEARS)
5030 IF RIGHT$(YY$,2) = "95" THEN D = DAYS - 9130
5031 IF RIGHT$(YY$,2) = "96" THEN D = DAYS - 9495: IF D > 59 THEN D = D + 1
5040 IF D > 0 AND D < 32 THEN MM$ = "Jan": DD$ = STR$(D)
5050 IF D > 31 AND D < 60 THEN MM$ = "Feb": D = D - 31: DD$ = STR$(D)
5060 IF D > 59 AND D < 91 THEN MM$ = "Mar": D = D - 59: DD$ = STR$(D)
5070 IF D > 90 AND D < 121 THEN MM$ = "Apr": D = D - 90: DD$ = STR$(D)
5080 IF D > 120 AND D < 152 THEN MM$ = "May": D = D - 120: DD$ = STR$(D)
5090 IF D > 151 AND D < 182 THEN MM$ = "Jun": D = D - 151: DD$ = STR$(D)
5100 IF D > 181 AND D < 213 THEN MM$ = "Jul": D = D - 181: DD$ = STR$(D)
5110 IF D > 212 AND D < 244 THEN MM$ = "Aug": D = D - 212: DD$ = STR$(D)
5120 IF D > 243 AND D < 274 THEN MM$ = "Sep": D = D - 243: DD$ = STR$(D)
5130 IF D > 273 AND D < 305 THEN MM$ = "Oct": D = D - 273: DD$ = STR$(D)
5140 IF D > 304 AND D < 335 THEN MM$ = "Nov": D = D - 304: DD$ = STR$(D)
5150 IF D > 334 AND D < 367 THEN MM$ = "Dec": D = D - 334: DD$ = STR$(D)
5151 IF VAL(DD$) < 10 THEN DD$ = "0" + RIGHT$(DD$, 1)
5160 SECS = S MOD 86400
5170 HOURS = FIX(SECS / 3600): AD$ = " am": IF HOURS > 11 THEN HOURS = HOURS - 12: AD$ = " pm"
5171 HH$ = STR$(HOURS): IF VAL(HH$) < 10 THEN HH$ = "0" + RIGHT$(HH$, 1)
5180 MINS = FIX((SECS MOD 3600) / 60): MIN$ = STR$(MINS): IF VAL(MIN$) < 10 THEN MIN$ = "0" + RIGHT$(MIN$, 1)
5190 DT$ = RIGHT$(YY$, 2) + RIGHT$(MM$, 3) + RIGHT$(DD$, 2)
5200 TM$ = RIGHT$(HH$, 2) + ":" + RIGHT$(MIN$, 2) + AD$
5205 RETURN

